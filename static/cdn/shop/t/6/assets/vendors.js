"use strict";(self.webpackChunkengo_borcen=self.webpackChunkengo_borcen||[]).push([[96],{456:function(e,t,s){function i(){var e=Error.call(this);return e.name="Server error",e.message="Something went wrong on the server",e.status=500,e}function n(e){var t=Error.call(this);return t.name="Not found",t.message="Not found",t.status=e,t}function r(){var e=Error.call(this);return e.name="Server error",e.message="Something went wrong on the server",e.status=500,e}function o(e){var t=Error.call(this);return t.name="Content-Type error",t.message="Content-Type was not provided or is of wrong type",t.status=e,t}function a(e){var t=Error.call(this);return t.name="JSON parse error",t.message="JSON syntax error",t.status=e,t}function u(e,t,s,i){var n=Error.call(this);return n.name=t,n.message=s,n.status=e,n.retryAfter=i,n}function c(e,t,s){var i=Error.call(this);return i.name=t,i.message=s,i.status=e,i}function l(e,t,s){var i=Error.call(this);return i.name=t,i.message=s,i.status=e,i}function h(){this.events={}}function d(e){this.eventName=e,this.callbacks=[]}function p(e){this._store={},this._keys=[],e&&e.bucketSize?this.bucketSize=e.bucketSize:this.bucketSize=20}function f(e,t){var s="";return t=t||null,Object.keys(e).forEach((function(i){var n=i+"=";switch(t&&(n=t+"["+i+"]"),function(e){return Object.prototype.toString.call(e).slice(8,-1).toLowerCase()}(e[i])){case"object":s+=f(e[i],t?n:i);break;case"array":s+=n+"="+e[i].join(",")+"&";break;default:t&&(n+="="),s+=n+encodeURIComponent(e[i])+"&"}})),s}s.d(t,{A:function(){return w}}),h.prototype.on=function(e,t){var s=this.events[e];s||(s=new d(e),this.events[e]=s),s.registerCallback(t)},h.prototype.off=function(e,t){var s=this.events[e];s&&s.callbacks.indexOf(t)>-1&&(s.unregisterCallback(t),0===s.callbacks.length&&delete this.events[e])},h.prototype.dispatch=function(e,t){var s=this.events[e];s&&s.fire(t)},d.prototype.registerCallback=function(e){this.callbacks.push(e)},d.prototype.unregisterCallback=function(e){var t=this.callbacks.indexOf(e);t>-1&&this.callbacks.splice(t,1)},d.prototype.fire=function(e){this.callbacks.slice(0).forEach((function(t){t(e)}))},p.prototype.set=function(e,t){if(this.count()>=this.bucketSize){var s=this._keys.splice(0,1);this.delete(s)}return this._keys.push(e),this._store[e]=t,this._store},p.prototype.get=function(e){return this._store[e]},p.prototype.has=function(e){return Boolean(this._store[e])},p.prototype.count=function(){return Object.keys(this._store).length},p.prototype.delete=function(e){var t=Boolean(this._store[e]);return delete this._store[e],t&&!this._store[e]};var y,v,b=(y=function(e,t,s,h,d){var p=new XMLHttpRequest,f=e+"/suggest.json";p.onreadystatechange=function(){if(p.readyState!==XMLHttpRequest.DONE);else{var e=p.getResponseHeader("Content-Type");if(p.status>=500)return void d(new r);if(404===p.status)return void d(new n(p.status));if("string"!=typeof e||null===e.toLowerCase().match("application/json"))return void d(new o(p.status));if(417===p.status){try{var t=JSON.parse(p.responseText);d(new c(p.status,t.message,t.description))}catch(e){d(new a(p.status))}return}if(422===p.status){try{var f=JSON.parse(p.responseText);d(new l(p.status,f.message,f.description))}catch(e){d(new a(p.status))}return}if(429===p.status){try{var y=JSON.parse(p.responseText);d(new u(p.status,y.message,y.description,p.getResponseHeader("Retry-After")))}catch(e){d(new a(p.status))}return}if(200===p.status){try{var v=JSON.parse(p.responseText);v.query=s,h(v)}catch(e){d(new a(p.status))}return}try{var b=JSON.parse(p.responseText);d(new i(p.status,b.message,b.description))}catch(e){d(new a(p.status))}}},p.open("get",f+"?q="+encodeURIComponent(s)+"&"+t),p.setRequestHeader("Content-Type","application/json"),p.send()},v=null,function(){var e=this,t=arguments;clearTimeout(v),v=setTimeout((function(){v=null,y.apply(e,t)}),10)});function _(e){if(!e)throw new TypeError("No config object was specified");var t=e;this._retryAfter=null,this._currentQuery=null,this.dispatcher=new h,this.cache=new p({bucketSize:40}),this.searchPath=t.search_path||"/search",t.search_path&&delete t.search_path,this.configParams=f(t)}function m(e){return"string"!=typeof e?null:e.trim().replace(" ","-").toLowerCase()}_.SEARCH_PATH="/search",_.TYPES={PRODUCT:"product",PAGE:"page",ARTICLE:"article",COLLECTION:"collection"},_.FIELDS={AUTHOR:"author",BODY:"body",PRODUCT_TYPE:"product_type",TAG:"tag",TITLE:"title",VARIANTS_BARCODE:"variants.barcode",VARIANTS_SKU:"variants.sku",VARIANTS_TITLE:"variants.title",VENDOR:"vendor"},_.UNAVAILABLE_PRODUCTS={SHOW:"show",HIDE:"hide",LAST:"last"},_.prototype.query=function(e){try{!function(e){var t;if(null==e)throw(t=new TypeError("'query' is missing")).type="argument",t;if("string"!=typeof e)throw(t=new TypeError("'query' is not a string")).type="argument",t}(e)}catch(e){return void this.dispatcher.dispatch("error",e)}if(""===e)return this;this._currentQuery=m(e);var t=this.cache.get(this._currentQuery);return t?(this.dispatcher.dispatch("success",t),this):(b(this.searchPath,this.configParams,e,function(e){this.cache.set(m(e.query),e),m(e.query)===this._currentQuery&&(this._retryAfter=null,this.dispatcher.dispatch("success",e))}.bind(this),function(e){e.retryAfter&&(this._retryAfter=e.retryAfter),this.dispatcher.dispatch("error",e)}.bind(this)),this)},_.prototype.on=function(e,t){return this.dispatcher.on(e,t),this},_.prototype.off=function(e,t){return this.dispatcher.off(e,t),this};var g={search_path:_.SEARCH_PATH,resources:{type:[_.TYPES.PRODUCT],options:{unavailable_products:_.UNAVAILABLE_PRODUCTS.LAST,fields:[_.FIELDS.TITLE,_.FIELDS.VENDOR,_.FIELDS.PRODUCT_TYPE,_.FIELDS.VARIANTS_TITLE]}}};function A(e){if(!(e&&e.selectors&&e.selectors.input&&T(e.selectors.input)&&e.selectors.result&&T(e.selectors.result)&&e.resultTemplateFct&&k(e.resultTemplateFct)&&e.numberOfResultsTemplateFct&&k(e.numberOfResultsTemplateFct)&&e.loadingResultsMessageTemplateFct&&k(e.loadingResultsMessageTemplateFct))){var t=new TypeError("PredictiveSearchComponent config is not valid");throw t.type="argument",t}var s,i,n;this.nodes=(s=e.selectors,{input:document.querySelector(s.input),reset:document.querySelector(s.reset),result:document.querySelector(s.result)}),(n=this.nodes)&&n.input&&n.result&&"INPUT"===n.input.tagName?(this._searchKeyword="",this.resultTemplateFct=e.resultTemplateFct,this.numberOfResultsTemplateFct=e.numberOfResultsTemplateFct,this.loadingResultsMessageTemplateFct=e.loadingResultsMessageTemplateFct,this.numberOfResults=e.numberOfResults||4,this.classes={visibleVariant:e.visibleVariant?e.visibleVariant:"predictive-search-wrapper--visible",itemSelected:e.itemSelectedClass?e.itemSelectedClass:"predictive-search-item--selected",clearButtonVisible:e.clearButtonVisibleClass?e.clearButtonVisibleClass:"predictive-search__clear-button--visible"},this.selectors={searchResult:e.searchResult?e.searchResult:"[data-search-result]"},this.callbacks=function(e){return{onBodyMousedown:e.onBodyMousedown,onBeforeOpen:e.onBeforeOpen,onOpen:e.onOpen,onBeforeClose:e.onBeforeClose,onClose:e.onClose,onInputFocus:e.onInputFocus,onInputKeyup:e.onInputKeyup,onInputBlur:e.onInputBlur,onInputReset:e.onInputReset,onBeforeDestroy:e.onBeforeDestroy,onDestroy:e.onDestroy}}(e),(i=this.nodes.input).setAttribute("autocorrect","off"),i.setAttribute("autocomplete","off"),i.setAttribute("autocapitalize","off"),i.setAttribute("spellcheck","false"),this._addInputEventListeners(),this._addBodyEventListener(),this._addAccessibilityAnnouncer(),this._toggleClearButtonVisibility(),this.predictiveSearch=new _(e.PredictiveSearchAPIConfig?e.PredictiveSearchAPIConfig:g),this.predictiveSearch.on("success",this._handlePredictiveSearchSuccess.bind(this)),this.predictiveSearch.on("error",this._handlePredictiveSearchError.bind(this))):console.warn("Could not find valid nodes")}function S(e){return Object.prototype.toString.call(e)}function T(e){return"[object String]"===S(e)}function E(e){return"[object Boolean]"===S(e)}function k(e){return"[object Function]"===S(e)}A.prototype.isResultVisible=!1,A.prototype.results={},A.prototype._latencyTimer=null,A.prototype._resultNodeClicked=!1,A.prototype._addInputEventListeners=function(){var e=this.nodes.input,t=this.nodes.reset;e&&(this._handleInputFocus=this._handleInputFocus.bind(this),this._handleInputBlur=this._handleInputBlur.bind(this),this._handleInputKeyup=this._handleInputKeyup.bind(this),this._handleInputKeydown=this._handleInputKeydown.bind(this),e.addEventListener("focus",this._handleInputFocus),e.addEventListener("blur",this._handleInputBlur),e.addEventListener("keyup",this._handleInputKeyup),e.addEventListener("keydown",this._handleInputKeydown),t&&(this._handleInputReset=this._handleInputReset.bind(this),t.addEventListener("click",this._handleInputReset)))},A.prototype._removeInputEventListeners=function(){var e=this.nodes.input;e.removeEventListener("focus",this._handleInputFocus),e.removeEventListener("blur",this._handleInputBlur),e.removeEventListener("keyup",this._handleInputKeyup),e.removeEventListener("keydown",this._handleInputKeydown)},A.prototype._addBodyEventListener=function(){this._handleBodyMousedown=this._handleBodyMousedown.bind(this),document.querySelector("body").addEventListener("mousedown",this._handleBodyMousedown)},A.prototype._removeBodyEventListener=function(){document.querySelector("body").removeEventListener("mousedown",this._handleBodyMousedown)},A.prototype._removeClearButtonEventListener=function(){var e=this.nodes.reset;e&&e.removeEventListener("click",this._handleInputReset)},A.prototype._handleBodyMousedown=function(e){if(this.isResultVisible&&null!==this.nodes)if(e.target.isEqualNode(this.nodes.input)||this.nodes.input.contains(e.target)||e.target.isEqualNode(this.nodes.result)||this.nodes.result.contains(e.target))this._resultNodeClicked=!0;else if(k(this.callbacks.onBodyMousedown)){var t=this.callbacks.onBodyMousedown(this.nodes);E(t)&&t&&this.close()}else this.close()},A.prototype._handleInputFocus=function(e){if(k(this.callbacks.onInputFocus)){var t=this.callbacks.onInputFocus(this.nodes);if(E(t)&&!t)return!1}return e.target.value.length>0&&this._search(),!0},A.prototype._handleInputBlur=function(){return setTimeout(function(){if(k(this.callbacks.onInputBlur)){var e=this.callbacks.onInputBlur(this.nodes);if(E(e)&&!e)return!1}return!document.activeElement.isEqualNode(this.nodes.reset)&&(this._resultNodeClicked?(this._resultNodeClicked=!1,!1):void this.close())}.bind(this)),!0},A.prototype._addAccessibilityAnnouncer=function(){this._accessibilityAnnouncerDiv=window.document.createElement("div"),this._accessibilityAnnouncerDiv.setAttribute("style","position: absolute !important; overflow: hidden; clip: rect(0 0 0 0); height: 1px; width: 1px; margin: -1px; padding: 0; border: 0;"),this._accessibilityAnnouncerDiv.setAttribute("data-search-announcer",""),this._accessibilityAnnouncerDiv.setAttribute("aria-live","polite"),this._accessibilityAnnouncerDiv.setAttribute("aria-atomic","true"),this.nodes.result.parentElement.appendChild(this._accessibilityAnnouncerDiv)},A.prototype._removeAccessibilityAnnouncer=function(){this.nodes.result.parentElement.removeChild(this._accessibilityAnnouncerDiv)},A.prototype._updateAccessibilityAttributesAfterSelectingElement=function(e,t){this.nodes.input.setAttribute("aria-activedescendant",t.id),e&&e.removeAttribute("aria-selected"),t.setAttribute("aria-selected",!0)},A.prototype._clearAriaActiveDescendant=function(){this.nodes.input.setAttribute("aria-activedescendant","")},A.prototype._announceNumberOfResultsFound=function(e){var t=this._accessibilityAnnouncerDiv.innerHTML,s=this.numberOfResultsTemplateFct(e);t===s&&(s+="&nbsp;"),this._accessibilityAnnouncerDiv.innerHTML=s},A.prototype._announceLoadingState=function(){this._accessibilityAnnouncerDiv.innerHTML=this.loadingResultsMessageTemplateFct()},A.prototype._handleInputKeyup=function(e){if(k(this.callbacks.onInputKeyup)){var t=this.callbacks.onInputKeyup(this.nodes);if(E(t)&&!t)return!1}if(this._toggleClearButtonVisibility(),this.isResultVisible&&null!==this.nodes){if(38===e.keyCode)return this._navigateOption(e,"UP"),!0;if(40===e.keyCode)return this._navigateOption(e,"DOWN"),!0;if(13===e.keyCode)return this._selectOption(),!0;27===e.keyCode&&this.close()}return e.target.value.length<=0?(this.close(),this._setKeyword("")):e.target.value.length>0&&this._search(),!0},A.prototype._handleInputKeydown=function(e){13===e.keyCode&&null!=this._getSelectedOption()&&e.preventDefault(),38!==e.keyCode&&40!==e.keyCode||e.preventDefault()},A.prototype._handleInputReset=function(e){if(e.preventDefault(),k(this.callbacks.onInputReset)){var t=this.callbacks.onInputReset(this.nodes);if(E(t)&&!t)return!1}return this.nodes.input.value="",this.nodes.input.focus(),this._toggleClearButtonVisibility(),this.close(),!0},A.prototype._navigateOption=function(e,t){var s=this._getSelectedOption();if(s)if("DOWN"===t){var i=s.nextElementSibling;i&&(s.classList.remove(this.classes.itemSelected),i.classList.add(this.classes.itemSelected),this._updateAccessibilityAttributesAfterSelectingElement(s,i))}else{var n=s.previousElementSibling;n&&(s.classList.remove(this.classes.itemSelected),n.classList.add(this.classes.itemSelected),this._updateAccessibilityAttributesAfterSelectingElement(s,n))}else{var r=this.nodes.result.querySelector(this.selectors.searchResult);r.classList.add(this.classes.itemSelected),this._updateAccessibilityAttributesAfterSelectingElement(null,r)}},A.prototype._getSelectedOption=function(){return this.nodes.result.querySelector("."+this.classes.itemSelected)},A.prototype._selectOption=function(){var e=this._getSelectedOption();e&&e.querySelector("a, button").click()},A.prototype._search=function(){var e=this.nodes.input.value;this._searchKeyword!==e&&(clearTimeout(this._latencyTimer),this._latencyTimer=setTimeout(function(){this.results.isLoading=!0,this._announceLoadingState(),this.nodes.result.classList.add(this.classes.visibleVariant),this.nodes.result.innerHTML=this.resultTemplateFct(this.results)}.bind(this),500),this.predictiveSearch.query(e),this._setKeyword(e))},A.prototype._handlePredictiveSearchSuccess=function(e){clearTimeout(this._latencyTimer),this.results=e.resources.results,this.results.isLoading=!1,this.results.products=this.results.products.slice(0,this.numberOfResults),this.results.canLoadMore=this.numberOfResults<=this.results.products.length,this.results.searchQuery=this.nodes.input.value,this.results.products.length>0||this.results.searchQuery?(this.nodes.result.innerHTML=this.resultTemplateFct(this.results),this._announceNumberOfResultsFound(this.results),this.open()):(this.nodes.result.innerHTML="",this._closeOnNoResults())},A.prototype._handlePredictiveSearchError=function(){clearTimeout(this._latencyTimer),this.nodes.result.innerHTML="",this._closeOnNoResults()},A.prototype._closeOnNoResults=function(){this.nodes&&this.nodes.result.classList.remove(this.classes.visibleVariant),this.isResultVisible=!1},A.prototype._setKeyword=function(e){this._searchKeyword=e},A.prototype._toggleClearButtonVisibility=function(){this.nodes.reset&&(this.nodes.input.value.length>0?this.nodes.reset.classList.add(this.classes.clearButtonVisible):this.nodes.reset.classList.remove(this.classes.clearButtonVisible))},A.prototype.open=function(){if(!this.isResultVisible){if(k(this.callbacks.onBeforeOpen)){var e=this.callbacks.onBeforeOpen(this.nodes);if(E(e)&&!e)return!1}return this.nodes.result.classList.add(this.classes.visibleVariant),this.nodes.input.setAttribute("aria-expanded",!0),this.isResultVisible=!0,k(this.callbacks.onOpen)&&this.callbacks.onOpen(this.nodes)||!0}},A.prototype.close=function(){if(!this.isResultVisible)return!0;if(k(this.callbacks.onBeforeClose)){var e=this.callbacks.onBeforeClose(this.nodes);if(E(e)&&!e)return!1}return this.nodes&&this.nodes.result.classList.remove(this.classes.visibleVariant),this.nodes.input.setAttribute("aria-expanded",!1),this._clearAriaActiveDescendant(),this._setKeyword(""),k(this.callbacks.onClose)&&this.callbacks.onClose(this.nodes),this.isResultVisible=!1,this.results={},!0},A.prototype.destroy=function(){if(this.close(),k(this.callbacks.onBeforeDestroy)){var e=this.callbacks.onBeforeDestroy(this.nodes);if(E(e)&&!e)return!1}var t;return this.nodes.result.classList.remove(this.classes.visibleVariant),(t=this.nodes.input).removeAttribute("autocorrect","off"),t.removeAttribute("autocomplete","off"),t.removeAttribute("autocapitalize","off"),t.removeAttribute("spellcheck","false"),this._removeInputEventListeners(),this._removeBodyEventListener(),this._removeAccessibilityAnnouncer(),this._removeClearButtonEventListener(),k(this.callbacks.onDestroy)&&this.callbacks.onDestroy(this.nodes),!0},A.prototype.clearAndClose=function(){this.nodes.input.value="",this.close()};var w=A}}]);